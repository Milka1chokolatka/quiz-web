import sqlite3

DB_NAME = 'quizes.db'
conn = None
cursor = None

def open():
    global conn, cursor
    conn = sqlite3.connect(DB_NAME)
    cursor = conn.cursor()

def close():
    global conn, cursor
    cursor.close()
    conn.close()

def create_tables():
    open()
    
    cursor.execute("""CREATE TABLE IF NOT EXISTS quiz(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title VARCHAR,
    description TEXT
    )""")

    cursor.execute("""CREATE TABLE IF NOT EXISTS questions(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    question VARCHAR,
    answer VARCHAR,
    wrong1 VARCHAR,
    wrong2 VARCHAR,
    wrong3 VARCHAR
    )""")

    cursor.execute("""CREATE TABLE IF NOT EXISTS quiz_questions(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    quiz_id INTEGER,
    question_id INTEGER,
    FOREIGN KEY (quiz_id) REFERENCES quiz (id),
    FOREIGN KEY (question_id) REFERENCES questions (id)
    )""")

    conn.commit()
    close()

def add_quizes():
    open()

    quizes = [
    ("Географія світу", "Перевір знання столиць, країн та природних об'єктів."),
    ("Історія людства", "Питання про ключові події та постаті світової історії."),
    ("Наука та технології", "Тест на розуміння наукових відкриттів і сучасних технологій."),
    ("Кіно та серіали", "Вікторина про відомі фільми, акторів та кінематографічні факти."),
    ("Музика", "Запитання про жанри, виконавців і хіти різних років."),
    ("Спорт", "Факти про спорт, олімпійські ігри та видатних спортсменів."),
    ("Література", "Перевір знання авторів, жанрів і сюжетів відомих творів."),
    ("Тваринний світ", "Питання про види тварин, їх середовище існування та особливості."),
    ("Логіка та мислення", "Завдання на логіку, уважність і нестандартне мислення."),
    ("Україна", "Вікторина про культуру, традиції, географію та історію України.")
    ]

    cursor.executemany("INSERT INTO quiz (title, description) VALUES (?, ?)", quizes)
    conn.commit()
    close()

def add_questions():
    open()
    questions = [

    # Географія світу — 5
    ("Столицею Франції є…", "Париж", "Ліон", "Марсель", "Ніцца"),
    ("Яка річка є найдовшою у світі?", "Ніл", "Амазонка", "Янцзи", "Міссісіпі"),
    ("Яка країна займає найбільшу площу?", "Росія", "Канада", "Китай", "США"),
    ("У якій частині світу розташована Сахара?", "Африка", "Південна Америка", "Азія", "Австралія"),
    ("Який океан є найбільшим?", "Тихий", "Атлантичний", "Індійський", "Північний Льодовитий"),

    # Історія людства — 5
    ("Хто був першим президентом США?", "Джордж Вашингтон", "Томас Джефферсон", "Авраам Лінкольн", "Джон Адамс"),
    ("У якому році відбулося падіння Римської імперії?", "476", "526", "312", "742"),
    ("Хто відкрив Америку у 1492 році?", "Христофор Колумб", "Марко Поло", "Фернан Магеллан", "Васко да Гама"),
    ("Яка війна вважається найбільшою у XX столітті?", "Друга світова війна", "Перша світова війна", "Корейська війна", "В'єтнамська війна"),
    ("Хто був відомим єгипетським фараоном-дитиною?", "Тутанхамон", "Рамзес II", "Аменхотеп", "Хеопс"),

    # Наука та технології — 5
    ("Хто сформулював закон всесвітнього тяжіння?", "Ісаак Ньютон", "Альберт Ейнштейн", "Галілео Галілей", "Макс Планк"),
    ("Яка планета відома як Червона?", "Марс", "Юпітер", "Меркурій", "Сатурн"),
    ("Одиниця електричного опору — це…", "Ом", "Ват", "Ампер", "Вольт"),
    ("Що є основною одиницею спадковості?", "Ген", "Клітина", "Хромосома", "Амінокислота"),
    ("Яка технологія лежить в основі бездротових мереж Wi-Fi?", "Радіохвилі", "Інфрачервоне світло", "Лазер", "Ультразвук"),

    # Кіно та серіали — 5
    ("Хто зіграв Джека у фільмі 'Титанік'?", "Леонардо Ді Капріо", "Бред Пітт", "Метт Деймон", "Том Круз"),
    ("Який фільм отримав Оскар у 1994 році?", "Форрест Гамп", "Втеча з Шоушенка", "Кримінальне чтиво", "Філадельфія"),
    ("Який супергерой носить костюм з павуком?", "Людина-павук", "Бетмен", "Залізна людина", "Тор"),
    ("У якому всесвіті відбуваються події серіалу 'Гра престолів'?", "Вестерос", "Нарнія", "Середзем'я", "Есгарот"),
    ("Хто створив всесвіт 'Зоряні війни'?", "Джордж Лукас", "Стівен Спілберг", "Джеймс Кемерон", "Рідлі Скотт"),

    # Музика — 5
    ("Який інструмент має клавіші і педалі?", "Фортепіано", "Скрипка", "Гітара", "Труба"),
    ("Хто виконав пісню 'Thriller'?", "Майкл Джексон", "Прінс", "Елвіс Преслі", "Фредді Мерк'юрі"),
    ("Який жанр характерний для Баха?", "Класична музика", "Рок", "Джаз", "Реп"),
    ("Яка група створила альбом 'The Dark Side of the Moon'?", "Pink Floyd", "Beatles", "Queen", "AC/DC"),
    ("Хто є автором гімну України?", "Михайло Вербицький", "Леся Українка", "Іван Франко", "Микола Лисенко"),

    # Спорт — 5
    ("Скільки гравців у футбольній команді на полі?", "11", "10", "12", "9"),
    ("Хто має найбільшу кількість золотих медалей на Олімпіадах?", "Майкл Фелпс", "Усейн Болт", "Лариса Латиніна", "Карл Льюїс"),
    ("У якому виді спорту використовується ракетка?", "Теніс", "Футбол", "Баскетбол", "Бокс"),
    ("Яка країна виграла ЧС з футболу 2018?", "Франція", "Бразилія", "Німеччина", "Аргентина"),
    ("Скільки секунд триває раунд у боксі?", "180", "120", "90", "240"),

    # Література — 5
    ("Хто написав 'Майстра і Маргариту'?", "Михайло Булгаков", "Лев Толстой", "Федір Достоєвський", "Олександр Пушкін"),
    ("Автор твору '1984' — це…", "Джордж Орвелл", "Олдос Гакслі", "Рей Бредбері", "Курт Воннегут"),
    ("Головний герой роману 'Гаррі Поттер' — це…", "Гаррі Поттер", "Фродо", "Персі Джексон", "Ераст Фандорін"),
    ("Хто написав 'Кобзар'?", "Тарас Шевченко", "Іван Франко", "Леся Українка", "Михайло Коцюбинський"),
    ("Жанр детективу передбачає…", "Розслідування злочину", "Фантастичні події", "Романтичну історію", "Подорож у часі"),

    # Тваринний світ — 5
    ("Яка тварина є найбільшою на Землі?", "Синій кит", "Африканський слон", "Білий ведмідь", "Жираф"),
    ("Який птах не вміє літати?", "Пінгвін", "Орел", "Голуб", "Сорока"),
    ("Хто є царем звірів?", "Лев", "Тигр", "Гепард", "Вовк"),
    ("Яка тварина впадає у зимову сплячку?", "Ведмідь", "Зебра", "Бегемот", "Лев"),
    ("У якому середовищі живуть дельфіни?", "Водному", "Пустельному", "Лісовому", "Гірському"),

    # Логіка та мислення — 5
    ("Скільки кутів має квадрат?", "4", "3", "5", "6"),
    ("Продовж ряд: 2, 4, 6, 8, ...", "10", "11", "9", "12"),
    ("Що важче: 1 кг заліза чи 1 кг пуху?", "Однаково", "Залізо", "Пух", "Залежить від об'єму"),
    ("Яке число зайве: 3, 5, 7, 9?", "9", "3", "5", "7"),
    ("Скільки секунд у одній хвилині?", "60", "50", "100", "30"),

    # Україна — 5
    ("Столиця України — це…", "Київ", "Львів", "Харків", "Одеса"),
    ("На якому морі розташована Одеса?", "Чорному", "Азовському", "Балтійському", "Середземному"),
    ("Нацвалюта України — …", "гривня", "рубль", "злотий", "лей"),
    ("Хто є автором вірша 'Заповіт'?", "Тарас Шевченко", "Леся Українка", "Іван Франко", "Микола Хвильовий"),
    ("Карпатські гори знаходяться на…", "Заході України", "Сході України", "Півдні України", "Півночі України")

    ]

    cursor.executemany("INSERT INTO questions (question, answer, wrong1, wrong2, wrong3) VALUES (?, ?, ?, ?, ?)", questions)
    conn.commit()
    close()

def add_links():
    open()
    cursor.execute("PRAGMA foreign_key=on")
    action = input("Додати зв'язок? (y/n)")
    while action != "n":
        quiz_id = int(input("Введіть номер вікторини"))
        question_id = int(input("Введіть номер запитання"))
        cursor.execute("""INSERT INTO quiz_questions (quiz_id, question_id) VALUES(?, ?)""", [quiz_id, question_id])
        conn.commit()
        action = input("Додати зв'язок? (y/n)")
    close()



def get_quizes():
    open()
    cursor.execute("SELECT * FROM quiz")
    quizes = cursor.fetchall()
    close()
    return quizes

def get_question_after(quiz_id=1, question_id=0):
   '''Повертає наступне питання до вибраної вікторини'''
   open()
   cursor.execute("""SELECT questions.id, questions.question, questions.answer, questions.wrong1, questions.wrong2, questions.wrong3
                  FROM questions, quiz_questions
                  WHERE quiz_questions.quiz_id = ? AND
                  quiz_questions.question_id > ? AND
                  quiz_questions.question_id = questions.id
                  ORDER BY quiz_questions.id""", (quiz_id, question_id))
   question = cursor.fetchone()
   close()
   return question



# def main():
    # create_tables()
    # add_quizes()
    # add_questions()
    # add_links()

# main()